var N=function(t,n){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])},N(t,n)},S=function(){return S=Object.assign||function(t){for(var n,r=1,e=arguments.length;r<e;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},S.apply(this,arguments)};function I(t,n,r){for(var e,o=0,i=n.length;o<i;o++)!e&&o in n||(e||(e=Array.prototype.slice.call(n,0,o)),e[o]=n[o]);return t.concat(e||Array.prototype.slice.call(n))}var L=function(t){function n(){return t!==null&&t.apply(this,arguments)||this}return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=r}N(r,e),r.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}(n,t),n}(Error),U={},T=new Set,O={};function w(t,n){if(typeof t=="string"||typeof t=="number"&&!isNaN(t)&&Math.abs(t)!==1/0||t==null||typeof t=="boolean")return t;var r=n.indexOf(t);if(r!==-1)return"#$@__instance__"+r;n.push(t);var e=n.length-1;if(t.constructor===Array){var o=t.map(function(s){return w(s,n)});return o.unshift("#$@__reference__"+e),o}if(t.constructor===Object){var i=Object.fromEntries(Object.entries(t).map(function(s){return[s[0],w(s[1],n)]}));return i["#$@__reference__"]=e,i}T.add(t.constructor);var a={};a=Object.defineProperty(a,"#$@__constructor__",{value:t.constructor.name,enumerable:!0}),a=Object.defineProperty(a,"#$@__reference__",{value:e,enumerable:!0});var c=function(s,u){if(Object.keys(O).includes(s.constructor.name))return O[s.constructor.name].toPlain(s,function(f){return w(f,u)})}(t,n);return c!==void 0?S(S({},c),a):(Object.getOwnPropertyNames(t).forEach(function(s){Object.defineProperty(a,s,{value:w(t[s],n),enumerable:!0})}),a)}function A(t,n,r){var e;if(typeof t=="string"&&t.indexOf("#$@__instance__")===0)return r[c=parseInt(t.slice(15))];if(typeof t=="string"||typeof t=="number"||t==null||typeof t=="boolean")return t;if(t.constructor===Array){if(t.length===0)return[];var o=t.shift();if(typeof o!="string"||o.substring(0,16)!=="#$@__reference__"){if(Object.keys(r).length===0)return t.unshift(o),t;throw new L}var i=[];r[c=o.slice(16)]=i;for(var a=0;a<t.length;a++)i[a]=A(t[a],n,r);return i}if(t.constructor===Object){var c;if((c=(e=t["#$@__reference__"])!==null&&e!==void 0?e:null)===null){if(Object.keys(r).length===0)return t;throw new L}if(delete t["#$@__reference__"],!Object.keys(t).includes("#$@__constructor__")){for(var s in i={},r[c]=i,t)i[s]=A(t[s],n,r);return i}var u=t["#$@__constructor__"];delete t["#$@__constructor__"];var f=function(h,g,m,d){if(Object.keys(O).includes(g))return O[g].fromPlain(h,function(b){return A(b,m,d)})}(t,u,n,r);if(f!==void 0)return f;if(!Object.keys(n).includes(u))throw new Error("The class "+u+" is not allowed");var p={};for(var s in r[c]=p,t)p[s]=A(t[s],n,r);return Object.setPrototypeOf(p,n[u].prototype),p}}function B(t){U[t.name]=t}function k(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(function(t,n){t("Date",r=>({time:r.getTime()}),function(r){let e=new Date;return e.setTime(r.time),e}),t("BigInt",r=>({number:r.toString()}),r=>BigInt(r.number)),t("String",r=>({text:r.toString()}),r=>new String(r.text)),t("RegExp",r=>({source:r.source,flags:r.flags}),r=>new RegExp(r.source,r.flags)),t("Number",function(r){let e={nan:!1,infinity:!1,positive:!0,number:null};return Math.abs(r)===1/0?(e.infinity=!0,e.positive=Math.abs(r)===r,e):isNaN(r)?(e.nan=!0,e):(e.number=r.valueOf(),e)},function(r){return r.nan?NaN:r.infinity?1/0*(r.positive?1:-1):new Number(r.number)}),t("Map",(r,e)=>({data:Array.from(r.entries()).map(o=>e(o))}),function(r,e){const o=new Map;return r.data.map(i=>e(i)).forEach(([i,a])=>o.set(i,a)),o}),t("Set",(r,e)=>({data:Array.from(r.values()).map(o=>e(o))}),function(r,e){const o=new Set;return r.data.map(i=>e(i)).forEach(i=>o.add(i)),o}),t("ArrayBuffer",(r,e)=>({data:e(new Uint8Array(r))}),(r,e)=>e(r.data).buffer),t("DataView",(r,e)=>({buffer:e(r.buffer),offset:r.byteOffset,length:r.byteLength}),(r,e)=>new DataView(e(r.buffer),r.offset,r.length)),[Error,EvalError,RangeError,AggregateError,ReferenceError,SyntaxError,TypeError,URIError,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array].forEach(r=>n(r))})(function(t,n,r){O[t]={toPlain:n,fromPlain:r}},B);var _,V={};function x(t){let n,r=t[0],e=1;for(;e<t.length;){const o=t[e],i=t[e+1];if(e+=2,(o==="optionalAccess"||o==="optionalCall")&&r==null)return;o==="access"||o==="optionalAccess"?(n=r,r=i(r)):o!=="call"&&o!=="optionalCall"||(r=i((...a)=>r.call(n,...a)),n=void 0)}return r}(_=V).defaults={},_.set=function(t,n,r){var e=r||{},o=_.defaults,i=e.expires||o.expires,a=e.domain||o.domain,c=e.path!==void 0?e.path:o.path!==void 0?o.path:"/",s=e.secure!==void 0?e.secure:o.secure,u=e.httponly!==void 0?e.httponly:o.httponly,f=e.samesite!==void 0?e.samesite:o.samesite,p=i?new Date(typeof i=="number"?new Date().getTime()+864e5*i:i):0;document.cookie=t.replace(/[^+#$&^`|]/g,encodeURIComponent).replace("(","%28").replace(")","%29")+"="+n.replace(/[^+#$&/:<-\[\]-}]/g,encodeURIComponent)+(p&&p.getTime()>=0?";expires="+p.toUTCString():"")+(a?";domain="+a:"")+(c?";path="+c:"")+(s?";secure":"")+(u?";httponly":"")+(f?";samesite="+f:"")},_.get=function(t){for(var n=document.cookie.split(";");n.length;){var r=n.pop(),e=r.indexOf("=");if(e=e<0?r.length:e,decodeURIComponent(r.slice(0,e).replace(/^\s+/,""))===t)return decodeURIComponent(r.slice(e+1))}return null},_.erase=function(t,n){_.set(t,"",{expires:-1,domain:n&&n.domain,path:n&&n.path,secure:0,httponly:0})},_.all=function(){for(var t={},n=document.cookie.split(";");n.length;){var r=n.pop(),e=r.indexOf("=");e=e<0?r.length:e,t[decodeURIComponent(r.slice(0,e).replace(/^\s+/,""))]=decodeURIComponent(r.slice(e+1))}return t};const j=[],$=t=>{(n=>{const r=typeof process<"u"&&x([process,"access",e=>e.env,"optionalAccess",e=>e.NODE_ENV])==="production";j.includes(n)||r||(typeof window>"u"&&(n+=`
Are you running on a server? Most of storages are not available while running on a server.`),console.warn(n),j.push(n))})(`Unable to find the ${t}. No data will be persisted.`)};let D=function(t){return t===void 0?"undefined":JSON.stringify(w(t,[]))},C=function(t,n){if(n===void 0&&(n=void 0),typeof t!="string")return t;if(n===void 0&&(n={}),t!=="undefined"){n=Object.fromEntries(I(I([],Object.entries(n),!0),Object.entries(U)));try{return A(JSON.parse(t),n,{})}catch{return t}}};function K(t,n,r){const e=n.getValue(r);return e!==null&&t.set(e),n.addListener&&n.addListener(r,o=>{t.set(o)}),t.subscribe(o=>{n.setValue(r,o)}),{...t,delete(){n.deleteValue(r)}}}function R(){}function Y(t=R,n=R){const r=[];return{callListeners(e,o){o!==void 0&&r.filter(({key:i})=>i===e).forEach(({listener:i})=>i(o))},addListener(e,o){r.push({key:e,listener:o}),r.length===1&&t()},removeListener(e,o){const i=r.indexOf({key:e,listener:o});i!==-1&&r.splice(i,1),r.length===0&&n()}}}function G(t,n=!1){const r=a=>{const c=a.key;a.storageArea===t&&o(c,C(a.newValue))},{removeListener:e,callListeners:o,addListener:i}=Y(()=>{n&&typeof window<"u"&&x([window,"optionalAccess",a=>a.addEventListener])&&window.addEventListener("storage",r)},()=>{n&&typeof window<"u"&&x([window,"optionalAccess",a=>a.removeEventListener])&&window.removeEventListener("storage",r)});return{addListener:i,removeListener:e,getValue(a){const c=t.getItem(a);return C(c)},deleteValue(a){t.removeItem(a)},setValue(a,c){t.setItem(a,D(c))}}}function q(t){try{return typeof window[t]=="object"}catch{return!1}}function Q(t=!1){return q("localStorage")?G(window.localStorage,t):($("window.localStorage"),z())}var M;function z(){return{getValue:()=>null,deleteValue(){},setValue(){}}}(function(t){t[t.LOCAL=0]="LOCAL",t[t.SESSION=1]="SESSION",t[t.SYNC=2]="SYNC"})(M||(M={}));var P,F=function(t){return Math.round(t/1099511627776)||32},J=function(t){var n,r=t.length;return r===0?0:(n=t[r-1],32*(r-1)+F(n))},X=function(t){var n,r="",e=t.length;for(n=0;n<e;n++)r+=(0xf00000000000+(0|t[n])).toString(16).substr(4);return r.substr(0,J(t)/4)};k(X);var W=function(t,n,r){return t===32?n:(0|n)+1099511627776*t},Z=function(t,n){if(32*t.length<n)return t;var r=(t=t.slice(0,Math.ceil(n/32))).length;return n&=31,r>0&&n&&(t[r-1]=W(n,t[r-1]&2147483648>>n-1)),t},H=function(t){var n,r,e,o=[];for(e=(t=t.replace(/\s|0x/g,"")).length,r=(t+="00000000").length,n=0;n<r;n+=8)o.push(0^parseInt(t.substr(n,8),16));return Z(o,4*e)};k(H);var l={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};l.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var n,r,e,o,i,a=this._tables[0][4],c=this._tables[1],s=t.length,u=1;if(s!==4&&s!==6&&s!==8)throw new l.exception.invalid("invalid aes key size");for(this._key=[o=t.slice(0),i=[]],n=s;n<4*s+28;n++)e=o[n-1],(n%s==0||s===8&&n%s==4)&&(e=a[e>>>24]<<24^a[e>>16&255]<<16^a[e>>8&255]<<8^a[255&e],n%s==0&&(e=e<<8^e>>>24^u<<24,u=u<<1^283*(u>>7))),o[n]=o[n-s]^e;for(r=0;n;r++,n--)e=o[3&r?n:n-4],i[r]=n<=4||r<4?e:c[0][a[e>>>24]]^c[1][a[e>>16&255]]^c[2][a[e>>8&255]]^c[3][a[255&e]]},l.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,n,r,e,o,i,a,c,s=this._tables[0],u=this._tables[1],f=s[4],p=u[4],h=[],g=[];for(t=0;t<256;t++)g[(h[t]=t<<1^283*(t>>7))^t]=t;for(n=r=0;!f[n];n^=e||1,r=g[r]||1)for(i=(i=r^r<<1^r<<2^r<<3^r<<4)>>8^255&i^99,f[n]=i,p[i]=n,c=16843009*h[o=h[e=h[n]]]^65537*o^257*e^16843008*n,a=257*h[i]^16843008*i,t=0;t<4;t++)s[t][n]=a=a<<24^a>>>8,u[t][i]=c=c<<24^c>>>8;for(t=0;t<5;t++)s[t]=s[t].slice(0),u[t]=u[t].slice(0)},_crypt:function(t,n){if(t.length!==4)throw new l.exception.invalid("invalid aes block size");var r,e,o,i,a=this._key[n],c=t[0]^a[0],s=t[n?3:1]^a[1],u=t[2]^a[2],f=t[n?1:3]^a[3],p=a.length/4-2,h=4,g=[0,0,0,0],m=this._tables[n],d=m[0],b=m[1],v=m[2],y=m[3],E=m[4];for(i=0;i<p;i++)r=d[c>>>24]^b[s>>16&255]^v[u>>8&255]^y[255&f]^a[h],e=d[s>>>24]^b[u>>16&255]^v[f>>8&255]^y[255&c]^a[h+1],o=d[u>>>24]^b[f>>16&255]^v[c>>8&255]^y[255&s]^a[h+2],f=d[f>>>24]^b[c>>16&255]^v[s>>8&255]^y[255&u]^a[h+3],h+=4,c=r,s=e,u=o;for(i=0;i<4;i++)g[n?3&-i:i]=E[c>>>24]<<24^E[s>>16&255]<<16^E[u>>8&255]<<8^E[255&f]^a[h++],r=c,c=s,s=u,u=f,f=r;return g}},l.bitArray={bitSlice:function(t,n,r){return t=l.bitArray._shiftRight(t.slice(n/32),32-(31&n)).slice(1),r===void 0?t:l.bitArray.clamp(t,r-n)},extract:function(t,n,r){var e=Math.floor(-n-r&31);return(-32&(n+r-1^n)?t[n/32|0]<<32-e^t[n/32+1|0]>>>e:t[n/32|0]>>>e)&(1<<r)-1},concat:function(t,n){if(t.length===0||n.length===0)return t.concat(n);var r=t[t.length-1],e=l.bitArray.getPartial(r);return e===32?t.concat(n):l.bitArray._shiftRight(n,e,0|r,t.slice(0,t.length-1))},bitLength:function(t){var n,r=t.length;return r===0?0:(n=t[r-1],32*(r-1)+l.bitArray.getPartial(n))},clamp:function(t,n){if(32*t.length<n)return t;var r=(t=t.slice(0,Math.ceil(n/32))).length;return n&=31,r>0&&n&&(t[r-1]=l.bitArray.partial(n,t[r-1]&2147483648>>n-1,1)),t},partial:function(t,n,r){return t===32?n:(r?0|n:n<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,n){if(l.bitArray.bitLength(t)!==l.bitArray.bitLength(n))return!1;var r,e=0;for(r=0;r<t.length;r++)e|=t[r]^n[r];return e===0},_shiftRight:function(t,n,r,e){var o,i,a;for(e===void 0&&(e=[]);n>=32;n-=32)e.push(r),r=0;if(n===0)return e.concat(t);for(o=0;o<t.length;o++)e.push(r|t[o]>>>n),r=t[o]<<32-n;return i=t.length?t[t.length-1]:0,a=l.bitArray.getPartial(i),e.push(l.bitArray.partial(n+a&31,n+a>32?r:e.pop(),1)),e},_xor4:function(t,n){return[t[0]^n[0],t[1]^n[1],t[2]^n[2],t[3]^n[3]]},byteswapM:function(t){var n,r;for(n=0;n<t.length;++n)r=t[n],t[n]=r>>>24|r>>>8&65280|(65280&r)<<8|r<<24;return t}},l.codec.utf8String={fromBits:function(t){var n,r,e="",o=l.bitArray.bitLength(t);for(n=0;n<o/8;n++)!(3&n)&&(r=t[n/4]),e+=String.fromCharCode(r>>>8>>>8>>>8),r<<=8;return decodeURIComponent(escape(e))},toBits:function(t){t=unescape(encodeURIComponent(t));var n,r=[],e=0;for(n=0;n<t.length;n++)e=e<<8|t.charCodeAt(n),(3&n)==3&&(r.push(e),e=0);return 3&n&&r.push(l.bitArray.partial(8*(3&n),e)),r}},l.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,n,r){var e,o="",i=0,a=l.codec.base64._chars,c=0,s=l.bitArray.bitLength(t);for(r&&(a=a.substr(0,62)+"-_"),e=0;6*o.length<s;)o+=a.charAt((c^t[e]>>>i)>>>26),i<6?(c=t[e]<<6-i,i+=26,e++):(c<<=6,i-=6);for(;3&o.length&&!n;)o+="=";return o},toBits:function(t,n){t=t.replace(/\s|=/g,"");var r,e,o=[],i=0,a=l.codec.base64._chars,c=0;for(n&&(a=a.substr(0,62)+"-_"),r=0;r<t.length;r++){if((e=a.indexOf(t.charAt(r)))<0)throw new l.exception.invalid("this isn't base64!");i>26?(i-=26,o.push(c^e>>>i),c=e<<32-i):c^=e<<32-(i+=6)}return 56&i&&o.push(l.bitArray.partial(56&i,c,1)),o}},l.codec.base64url={fromBits:function(t){return l.codec.base64.fromBits(t,1,1)},toBits:function(t){return l.codec.base64.toBits(t,1)}},l.mode.gcm={name:"gcm",encrypt:function(t,n,r,e,o){var i,a=n.slice(0),c=l.bitArray;return o=o||128,e=e||[],i=l.mode.gcm._ctrMode(!0,t,a,e,r,o),c.concat(i.data,i.tag)},decrypt:function(t,n,r,e,o){var i,a,c=n.slice(0),s=l.bitArray,u=s.bitLength(c);if(e=e||[],(o=o||128)<=u?(a=s.bitSlice(c,u-o),c=s.bitSlice(c,0,u-o)):(a=c,c=[]),i=l.mode.gcm._ctrMode(!1,t,c,e,r,o),!s.equal(i.tag,a))throw new l.exception.corrupt("gcm: tag doesn't match");return i.data},_galoisMultiply:function(t,n){var r,e,o,i,a,c=l.bitArray._xor4;for(o=[0,0,0,0],i=n.slice(0),r=0;r<128;r++){for(t[Math.floor(r/32)]&1<<31-r%32&&(o=c(o,i)),a=(1&i[3])!=0,e=3;e>0;e--)i[e]=i[e]>>>1|(1&i[e-1])<<31;i[0]=i[0]>>>1,a&&(i[0]=i[0]^225<<24)}return o},_ghash:function(t,n,r){var e,o,i=r.length;for(e=n.slice(0),o=0;o<i;o+=4)e[0]^=4294967295&r[o],e[1]^=4294967295&r[o+1],e[2]^=4294967295&r[o+2],e[3]^=4294967295&r[o+3],e=l.mode.gcm._galoisMultiply(e,t);return e},_ctrMode:function(t,n,r,e,o,i){var a,c,s,u,f,p,h,g,m,d,b,v,y=l.bitArray;for(m=r.length,d=y.bitLength(r),b=y.bitLength(e),v=y.bitLength(o),a=n.encrypt([0,0,0,0]),v===96?(c=o.slice(0),c=y.concat(c,[1])):(c=l.mode.gcm._ghash(a,[0,0,0,0],o),c=l.mode.gcm._ghash(a,c,[0,0,Math.floor(v/4294967296),4294967295&v])),s=l.mode.gcm._ghash(a,[0,0,0,0],e),p=c.slice(0),h=s.slice(0),t||(h=l.mode.gcm._ghash(a,s,r)),f=0;f<m;f+=4)p[3]++,u=n.encrypt(p),r[f]^=u[0],r[f+1]^=u[1],r[f+2]^=u[2],r[f+3]^=u[3];return r=y.clamp(r,d),t&&(h=l.mode.gcm._ghash(a,s,r)),g=[Math.floor(b/4294967296),4294967295&b,Math.floor(d/4294967296),4294967295&d],h=l.mode.gcm._ghash(a,h,g),u=n.encrypt(c),h[0]^=u[0],h[1]^=u[1],h[2]^=u[2],h[3]^=u[3],{tag:y.bitSlice(h,0,i),data:r}}},function(t){t[t.EXCEPTION=0]="EXCEPTION",t[t.NO_ENCRYPTION=1]="NO_ENCRYPTION",t[t.NO_STORAGE=2]="NO_STORAGE"}(P||(P={}));export{Q as I,K as j};
